[include file="Inc/header" /]
<style>
    .hqyzm{
        width: 40%;text-align: center;background-color: #3879D9;display: inline-block;height: 33px;line-height: 33px;margin-left:9%;border-radius:4px;color: white;
        float: ;
    }
    .ccc{
        background: #c0c0c0;
    }
</style>
    <div class="box">
        <!-- user center -->
        <div class="p_user_center fl oh">
            [include file="Inc/login" /]
        </div>
        <!-- p_right -->
        <div class="p_right fr oh">
            <div class="p_content cl oh">
                <div class="site"><a href="__ROOT__/"><i class="icon-home2"></i>  首页</a> > 会员注册</div>
                <div class="register">
                    <form id="myform2" class="form-horizontal form-1" action="#" method="post" accept-charset="utf-8">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">用户名：</label>
                            <div class="col-sm-10">
                                <input type="text" name="username" class="form-control" fs="填写用户名" datatype="*">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">手机号码：</label>
                            <div class="col-sm-10">
                                <input type="text" name="phone" class="form-control" fs="填写手机号码" datatype="m" errormsg="手机号码格式不正确">
                            </div>   
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">验证码：</label>
                            <div class="col-sm-10">
                                <input type="text" id="yzm"  class="form-control" style="width: 50%;float: left"><span class="hqyzm">获取验证码</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">姓名：</label>
                            <div class="col-sm-10">
                                <input type="text" name="name" class="form-control" fs="必须为2-4汉字" datatype="/^[\u4e00-\u9fa5]{2,4}$/" errormsg="姓名不正确">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">性别：</label>
                            <div class="col-sm-10">
                                <span class="formtext">男 <input type="radio" name="sex" value="男">　女 <input type="radio" name="sex" value="女"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">年龄：</label>
                            <div class="col-sm-10">
                                <input type="text" name="age" class="form-control" fs="填写数字" datatype="n1-100" errormsg="年龄必须为数字">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">身份证号：</label>
                            <div class="col-sm-10">
                                <input type="text" name="idcard" class="form-control">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">邮寄地址：</label>
                            <div class="col-sm-10">
                                <input type="text" name="address" class="form-control" nullmsg="请填写邮寄地址" datatype="*">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputPassword3" class="col-sm-2 control-label">登录密码：</label>
                            <div class="col-sm-10">
                                <input type="password" name="password" class="form-control" datatype="*6-16" nullmsg="请设置密码" errormsg="密码长度在6~16位之间">
                            </div>
                         </div>
                        <div class="form-group">
                            <label for="inputPassword3" class="col-sm-2 control-label">确认密码：</label>
                            <div class="col-sm-10">
                                <input type="password" name="password2" class="form-control" datatype="*" recheck="password" nullmsg="请再输入一次密码" errormsg="您两次输入的账号密码不一致">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="submit" class="btn btn-success" id="zc" style="margin-left: 50%;margin-top: 10px;;">点击注册</button>
                            </div>
                        </div>
                        <!--<input type="text" name="score" value="200" style="display: none;">-->
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div style="height:5px;clear:both;"></div>
<script>
    var yzm={};
    $.fn.mask = function () {
        var divHtml = '<div class="divMask" style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; background: #fff; opacity: 0; filter: alpha(opacity=0)"> </div>';
        $(this).wrap('<span style="position: relative"></span>');
        $(this).parent().append(divHtml);
        $(this).data("mask","true");
    }
    //取消屏蔽
    $.fn.unmask = function () {
        $(this).parent().find(".divMask").remove();
        $(this).unwrap();
        $(this).data("mask", "false");
    }
    $(function(){
        var t;
        $('.hqyzm').click(function(){
            var phone=$('input[name=phone]').val();
            if(phone==''){
                alert('请输入手机号');
                return;
            }
            $.ajax({
                "dataType": 'jsonP',
                "type": "POST",
                "url": "http://192.168.199.238:8098/coupon/coupon/backvcode.htm",
                "data": {usermobile: phone},
                "jsonp":'jsonpCallback',
                "cache": false,
                "success": function (data) {
                    var tmp=eval(data);
                    if(tmp.msg){
                        alert(tmp.msg);
                        $(that).removeClass('ccc');
                        $(that).unmask("disabled");
                        clearInterval(t);
                        $(that).text('获取验证码');
                    }else{
                        yzm.yzm=tmp.vcode;
                    }
                }
            })
            var s=1;
            var that=this;
            if(typeof t=='function'){
                clearInterval(t);
            }
            t=setInterval(function(){
                $(that).text((60-s)+'秒后再发送');
                $(that).addClass('ccc');
                $(that).mask("disabled");
                s++;
                if(s>60){
                    $(that).removeClass('ccc');
                    $(that).unmask("disabled");
                    clearInterval(t);
                    $(that).text('获取验证码');
                }
            },1000)
        })
        $('input[name=phone]').change(function(){
            var val=$.trim($(this).val());
            var reg= /^(1[3|5|8][0-9]|14[5|7]|17[6|7|8])\d{8}$/;
            if(!reg.test(val)){
                alert('手机号有误');
                return;
            }
        })
        $('#yzm').change(function(){
            if($(this).val()!= yzm.yzm){
                $('#zc').mask();
                alert('验证码输入有误,请重新输入!');
            }else{
                $('#zc').unmask();
            }
        })
    })
</script>
[include file="Inc/footer" /]